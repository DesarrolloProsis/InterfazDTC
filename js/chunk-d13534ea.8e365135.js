(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d13534ea"],{"44e8":function(t,e,a){},"4e2f":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"border h-79 -mb-56 relative"},[e("HeaderPreventivo",{attrs:{header:t.header,referenceNumber:t.referenceNumber},on:{"guarar-log-fecha":t.guardar_log_fecha,"guardar-adminId-nuevo":t.modificar_adminid}}),e("Spinner",{attrs:{modalLoading:t.modalLoading}}),e("TablaActividadesCarril",{attrs:{listaActividades:t.listaActividades,calendarioId:t.header.calendarId,referenceNumber:t.referenceNumber}}),e("div",{staticClass:"inline-flex mx-auto w-full pl-20 pr-20 sm:grid grid-cols-1 font-titulo mt-6 -mb-32"},[e("div",{staticClass:"w-1/2 sm:w-full sm:-ml-10"},[e("p",{staticClass:"text-center text-xl text-gray-800 mb-6 sm:text-xs sm:-ml-48 sm:-mt-6"},[t._v("Observaciones")]),e("div",{staticClass:"absolute ml-57 -mt-8 sm:hidden md:hidden lg:-mt-8 lg:ml-49 w-6 hidden"},[e("span",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:{ref:"tooltipobservacion",class:"tooltip-custom tooltip-other-custom"},expression:" { ref:'tooltipobservacion', class: 'tooltip-custom tooltip-other-custom'}",modifiers:{top:!0}}]},[e("font-awesome-icon",{staticClass:"text-blue-600 w-5 h-5 flex items-center",attrs:{icon:"fa-solid fa-circle-info"}})],1),e("div",{ref:"tooltipobservacion",staticClass:"font-titulo"},[e("p",{staticClass:"text-center text-gray-800"},[t._v("Se debe indicar las acciones ")])])]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.observaciones,expression:"observaciones"}],staticClass:"block container mx-auto py-4 mb-0 h-40 is_valid placeholder-gray-500 sm:text-sm ph-center-observaciones sm:h-24 sm:w-66 sm:-ml-6 sm:-mt-3",attrs:{id:"obs",placeholder:"Observaciones del Mantenimiento Preventivo",name:"Observaciones",maxlength:t.limite},domProps:{value:t.observaciones},on:{input:function(e){e.target.composing||(t.observaciones=e.target.value)}}}),t._v(" "),e("span",{staticClass:"text-xs text-gray-500 sm:ml-24"},[t._v(t._s(t.restante)+"/300")])]),e("div",{staticClass:"w-1/2 ml-20 sm:w-full sm:-ml-16 sm:-mt-1 mt-3"},[e("ImagenesActividadCarril",{attrs:{reporteDataInsertada:t.reporteInsertado,referenceNumber:t.referenceNumber},on:{"ocutar-modal-loading":t.ocultar_modal_loading}})],1),e("div",{staticClass:"w-1/2 justify-end flex sm:grid grid-cols-1 sm:w-full sm:-mb-48"},[t.reporteInsert?e("div",[t.reporteInsertado?e("div",[e("button",{staticClass:"mt-32 sm:mt-8 botonCrearFoto h-16 w-44",class:{botonDeshabilitado:t.modalLoading},attrs:{disabled:t.modalLoading,disable:t.modalLoading},on:{click:function(e){return t.crear_header_reporte(!1)}}},[e("font-awesome-icon",{staticClass:"mr-2 text-blue-800 h-8",attrs:{icon:"fa-solid fa-camera"}}),e("span",[t._v("Crear Reporte Fotografico")])],1)]):e("div",[e("button",{staticClass:"mt-32 sm:mt-8 botonCrearReporte h-16 w-44",class:{botonDeshabilitado:t.modalLoading},attrs:{disabled:t.modalLoading,disable:t.modalLoading},on:{click:function(e){return t.crear_header_reporte(!0)}}},[e("font-awesome-icon",{staticClass:"mr-2 text-green-800 h-8",attrs:{icon:"fa-solid fa-floppy-disk"}}),e("span",[t._v("Crear Reporte Actividades")])],1)])]):e("div",[e("button",{staticClass:"mt-32 sm:mt-8 botonIconActualizar font-black h-16 w-44",class:{botonDeshabilitado:t.modalLoading},attrs:{disabled:t.modalLoading,disable:t.modalLoading},on:{click:t.crear_header_reporte}},[e("font-awesome-icon",{staticClass:"mr-2 text-yellow-600 h-8",attrs:{icon:"fa-solid fa-file-pen"}}),e("span",[t._v("Actualizar Reportes")])],1)])])])],1)},s=[],o=a("c7eb"),r=a("1da1"),n=(a("d3b7"),a("159b"),a("b0c0"),a("ac1f"),a("1276"),a("e9c4"),a("99af"),a("d81d"),a("4de4"),function(){var t=this,e=t._self._c;return e("div",{},[e("div",{staticClass:"text-2xl text-center inline-flex sm:inline-block w-full mt-10"},[t._m(0),e("div",{staticClass:"w-2/3 sm:w-auto sm:-mt-3 sm:text-sm flex justify-start sm:justify-center"},[e("div",{},[e("h1",{staticClass:"mt-5 font-titulo font-bold text-3xl sm:text-lg"},[t._v(t._s("Mantenimiento Preventivo ".concat(t.header.frequencyName," Nivel ").concat(t.tituloUbicacion)))])])])]),e("div",{staticClass:"inline-flex sm:inline-block w-full"},[e("div",{staticClass:"w-2/3 sm:w-full inline-flex sm:inline-block text-base sm:text-xs"},[e("div",{staticClass:"w-1/2 sm:w-full p-8 sm:p-2"},[e("div",{staticClass:"flex justify-starts m-5 sm:ml-3 -ml-1"},[e("p",{staticClass:"font-titulo font-bold"},[t._v("Numero de Reporte:")]),e("h2",{staticClass:"font-titulo ml-5"},[t._v(t._s(t.referenceNumber))])]),e("div",{staticClass:"flex justify-start m-5 sm:ml-3 -ml-1"},[e("p",{staticClass:"font-titulo font-bold"},[t._v("Plaza de Cobro:")]),e("p",{staticClass:"font-titulo ml-5"},[t._v(t._s(t.header.plazaNombre))])]),e("div",{staticClass:"flex justify-start m-5 sm:ml-3 -ml-1"},[e("p",{staticClass:"font-titulo font-bold"},[t._v("Ubicacion:")]),e("p",{staticClass:"font-titulo ml-5"},[t._v(t._s(t.header.lane))])])]),e("div",{staticClass:"w-1/2 sm:w-full sm:-mt-10 p-8 sm:p-2"},[e("div",{staticClass:"flex justify-start sm:ml-3 m-5"},[e("p",{staticClass:"font-titulo font-bold"},[t._v("Fecha:")]),e("p",{staticClass:"font-titulo ml-5"},[t._v(t._s(t.header.day))]),t.$route.query.edicion?t._e():e("p",{staticClass:"ml-5 text-sm cursor-pointer text-blue-700 font-boton font-bold",on:{click:t.modalCambiarFecha}},[t._v("Cambiar Fecha")])]),e("div",{staticClass:"flex justify-start m-5 sm:ml-3"},[e("p",{staticClass:"font-titulo font-bold"},[t._v("Hora Inicio:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.horaInicio,expression:"horaInicio"}],staticClass:"ml-5 w-40 is_valid font-titulo",attrs:{type:"time"},domProps:{value:t.horaInicio},on:{input:function(e){e.target.composing||(t.horaInicio=e.target.value)}}})]),e("div",{staticClass:"flex justify-start m-5 sm:ml-3"},[e("p",{staticClass:"font-titulo font-bold"},[t._v("Hora Fin:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.horaFin,expression:"horaFin"}],staticClass:"ml-5 w-40 is_valid font-titulo",attrs:{type:"time"},domProps:{value:t.horaFin},on:{input:function(e){e.target.composing||(t.horaFin=e.target.value)}}})]),e("div",{staticClass:"justify-start m-5 sm:ml-3 grid grid-cols-1"},[e("p",{staticClass:"font-titulo font-bold -my-6"},[t._v("Encargado de Plaza:")]),e("p",[e("select",{directives:[{name:"model",rawName:"v-model",value:t.adminIdCalendar,expression:"adminIdCalendar"}],staticClass:"is_valid",on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.adminIdCalendar=e.target.multiple?a:a[0]},t.enviar_nuevo_admin_id]}},t._l(t.listaPlazaAdminValid,(function(a,i){return e("option",{key:i,domProps:{value:a.administradorId}},[t._v(t._s(a.plazaAdminNombre))])})),0)])])])]),t._m(1)]),e("div",{staticClass:"sticky inset-0",class:{"modal-container":t.showModal}},[t.showModal?e("div",{staticClass:"rounded-lg justify-center absolute inset-x-0 md:w-69 lg:w-69 xl:w-69 mx-auto px-2 sm:p-2 mt-40"},[e("ValidationObserver",{ref:"observer"},[e("div",{staticClass:"rounded-lg border bg-white border-gray-400 px-12 py-10 sm:px-6 shadow-2xl"},[e("p",{staticClass:"text-gray-900 font-titulo font-thin text-md"},[t._v("Indica la fecha y el motivo por el cual desea cambiar la fecha")]),e("div",[e("div",{staticClass:"mt-5 sm:grid grid-cols-1"},[e("div",{staticClass:"justify-start grid grid-cols-2 font-titulo"},[e("p",{staticClass:"font-bold"},[t._v("Fecha Original:")]),e("p",{staticClass:"ml-5 text-center"},[t._v(t._s(t.header.day))])]),e("br"),e("div",{staticClass:"grid grid-cols-2 sm:grid-cols-2 font-titulo"},[e("ValidationProvider",{attrs:{name:"Nueva Fecha",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(a){var i=a.errors;return[e("p",{staticClass:"font-bold my-1 sm:text-sm"},[t._v("Nueva Fecha *:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.fechaCambio,expression:"fechaCambio"}],staticClass:"border w-40 is_valid sm:mb-6 sm:-mt-1",attrs:{type:"date"},domProps:{value:t.fechaCambio},on:{input:function(e){e.target.composing||(t.fechaCambio=e.target.value)}}}),e("span",{staticClass:"text-red-600 text-xs block"},[t._v(t._s(i[0]))])]}}],null,!1,208783523)})],1)]),e("div",{staticClass:"mt-5 font-titulo"},[e("ValidationProvider",{attrs:{name:"Motivo del Cambio",rules:"required:max:300"},scopedSlots:t._u([{key:"default",fn:function(a){var i=a.errors;return[e("p",{staticClass:"mb-1 sm:text-sm"},[t._v("Motivo del Cambio *:")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.motivoCambioFecha,expression:"motivoCambioFecha"}],staticClass:"textAreaCalendario text-center",attrs:{placeholder:"Motivo del cambio",name:"Motivo"},domProps:{value:t.motivoCambioFecha},on:{input:function(e){e.target.composing||(t.motivoCambioFecha=e.target.value)}}}),t._v(" "),e("span",{staticClass:"text-xs text-gray-500"},[t._v(t._s(t.restante)+"/300")]),e("span",{staticClass:"text-red-600 text-xs block"},[t._v(t._s(i[0]))])]}}],null,!1,753759976)})],1)]),e("div",{staticClass:"justify-center flex -mt-5 -mb-6 sm:-mt-3"},[e("button",{staticClass:"botonIconCrear m-6 sm:m-3",on:{click:t.botoncambiar_modal}},[t._v("Cambiar")]),e("button",{staticClass:"botonIconCancelar font-boton m-6 sm:m-3",on:{click:t.botoncancelar_modal}},[t._v("Cancelar")])])])])],1):t._e()])])}),c=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-auto mx-auto flex justify-center"},[e("div",{staticClass:"w-66 p-5 sm:ml-16 sm:-mt-10"},[e("img",{staticClass:"h-12 w-48",attrs:{src:a("afbd")}})])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-1/3 sm:w-full uppercase text-xs sm:text-xs p-10 sm:p-5"},[e("p",{staticClass:"font-titulo font-bold"},[t._v("Estatus Equipo:")]),e("div",{staticClass:"flex justify-between mt-2 ml-2"},[e("p",{staticClass:"font-titulo"},[t._v("Operando en optimas condiciones")]),e("div",{staticClass:"bg-green-500 border-gray-800 border w-20 h-6 ml-3 text-center is_valid -mt-1 font-titulo"},[e("p",{staticClass:"mt-1 mb-1 text-white"},[t._v("Ok")])])]),e("div",{staticClass:"flex justify-between mt-2 ml-2 font-titulo"},[e("p",[t._v("Equipo con Daño Fisico y/o Vandalizado")]),e("div",{staticClass:"bg-yellow-500 border-gray-800 border w-20 h-6 ml-3 text-center is_valid -mt-1 sm:mt-1"},[e("p",{staticClass:"mt-1 text-white"},[t._v("Dañado")])])]),e("div",{staticClass:"flex justify-between mt-2 ml-2 font-titulo"},[e("p",[t._v("No aplica por garantia con el fabricante")]),e("div",{staticClass:"bg-orange-500 border-gray-800 border w-20 h-6 ml-3 text-center is_valid -mt-1 sm:mt-1"},[e("p",{staticClass:"mt-1 text-white"},[t._v("No Aplica")])])]),e("div",{staticClass:"flex justify-between mt-2 ml-2 font-titulo"},[e("p",[t._v("No Existe Equipo (Vandalizado)")]),e("div",{staticClass:"bg-red-500 border-gray-800 border w-20 h-6 ml-3 text-center is_valid -mt-1 sm:-mt-1"},[e("p",{staticClass:"mt-1 text-white"},[t._v("No Existe")])])])])}],l=a("11b3"),m=a("9909"),d=a("c1df"),u=a.n(d),f={data:function(){return{showModal:!1,horaInicio:"",horaFin:"",fechaCambio:"",motivoCambioFecha:"",limite:300,tituloUbicacion:"",listaPlazaAdminValid:[],adminIdCalendar:""}},props:{header:{type:Object,default:function(){}},referenceNumber:{type:String,default:function(){return""}}},beforeMount:function(){var t=Object(r["a"])(Object(o["a"])().mark((function t(){var e=this;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.listaPlazaAdminValid=this.$store.state.Login.cookiesUser.plazasUsuario.filter((function(t){return t.numeroPlaza==e.header.squareId&&1==t.statusAdmin})),this.adminIdCalendar=this.header.adminId,this.$emit("guardar-adminId-nuevo",this.adminIdCalendar),this.tituloUbicacion="0000"==this.header.capufeLaneNum?"Plaza":"Carril",this.horaInicio=this.$route.query.horas.horaInicio,this.horaFin=this.$route.query.horas.horaFin;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),computed:{restante:function(){return this.motivoCambioFecha.length}},methods:{modalCambiarFecha:function(){this.showModal=!0},botoncambiar_modal:function(){var t=Object(r["a"])(Object(o["a"])().mark((function t(){var e,a,i,s,r,n;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""==this.fechaCambio||""==this.motivoCambioFecha){t.next=27;break}if(e=new Date,a=e.getMonth(),a+=1,i=new Date(this.fechaCambio),s=i.getMonth(),s+=1,i.setDate(i.getDate()),!(s>a||s<a)){t.next=13;break}this.$notify.warning({title:"Ops!! ",msg:"FECHA INVALIDA",position:"bottom right",styles:{height:100,width:500}}),this.fechaCambio="",t.next=25;break;case 13:return this.fechaCambio=u()(this.fechaCambio,"YYYY-MM-DD").format("DD/MM/YYYY"),t.next=16,this.$store.getters["Login/GET_REFERENCIA_PLAZA_TO_NOMBRE"](this.header.plazaNombre).refereciaPlaza;case 16:return r=t.sent,t.next=19,m["a"].crear_referencia_calendario(r,this.header.frequencyName,this.fechaCambio,this.header.lane);case 19:n=t.sent,this.$emit("guarar-log-fecha",{fecha:this.fechaCambio,motivo:this.motivoCambioFecha,ref:n}),this.header.day=this.fechaCambio,this.showModal=!1,this.fechaCambio="",this.motivoCambioFecha="";case 25:t.next=28;break;case 27:this.$notify.warning({title:"* Son datos obligatorios",msg:"NO SE SELECCIONÓ ALGUNO DE LOS DATOS NECESARIOS",position:"bottom right",styles:{height:100,width:500}});case 28:case 29:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),botoncancelar_modal:function(){this.showModal=!1,this.fechaCambio="",this.motivoCambioFecha=""},enviar_nuevo_admin_id:function(){this.$emit("guardar-adminId-nuevo",this.adminIdCalendar)}},watch:{horaInicio:function(t){l["a"].$emit("actualizar_hora_inicio",t)},horaFin:function(t){l["a"].$emit("actualizar_hora_fin",t)}}},h=f,p=(a("f1c9"),a("2877")),b=Object(p["a"])(h,n,c,!1,null,null,null),g=b.exports,v=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"flex justify-center p-2"},[e("div",{staticClass:"grid gap-4 grid-cols-1",class:{"opacity-50":t.deshabilitar}},[e("div",{staticClass:"divtabla sm:text-xs",class:{"overflow-x-auto":t.scrollBool}},[e("table",{staticClass:"table table-striped",staticStyle:{height:"550px"}},[t._m(0),e("transition-group",{tag:"tbody",attrs:{name:"table"}},t._l(t.listaActividades,(function(a,i){return e("tr",{key:i,staticClass:"h-12 text-gray-900"},[e("td",{staticClass:"w-66 cuerpoTable font-titulo font-normal text-center"},[t._v(t._s(a.equipo))]),e("td",{staticClass:"w-66 cuerpoTable font-titulo font-normal text-center"},[t._v(t._s(a.componente))]),e("td",{staticClass:"w-66 cuerpoTable font-titulo font-normal text-center"},[t._v(t._s(a.actividades))]),e("td",{staticClass:"w-66 cuerpoTable font-titulo font-normal text-center"},[t._v(t._s(a.ubicacion))]),e("td",{staticClass:"w-66 cuerpoTable font-titulo font-normal text-center"},[e("select",{directives:[{name:"model",rawName:"v-model",value:a.jobStatus,expression:"item.jobStatus"}],staticClass:"w-32 text-md text-gray-800 is_valid ml-20 sm:ml-0",class:{"bg-green-500":1==a.jobStatus,"bg-yellow-500":2==a.jobStatus,"bg-orange-500":3==a.jobStatus,"bg-red-500":4==a.jobStatus},on:{change:[function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(a,"jobStatus",e.target.multiple?i:i[0])},function(e){return t.actualizar_actividad(a)}]}},[e("option",{attrs:{value:"0"}},[t._v("Seleccione...")]),e("option",{staticClass:"bg-green-500",attrs:{value:"1"}},[t._v("Ok")]),e("option",{staticClass:"bg-yellow-500",attrs:{value:"2"}},[t._v("Dañado")]),e("option",{staticClass:"bg-orange-500",attrs:{value:"3"}},[t._v("No Aplica")]),e("option",{staticClass:"bg-red-500",attrs:{value:"4"}},[t._v("No Existe")])])])])})),0)],1)])])])])},C=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",{staticClass:"text-md h-16 trTable"},[e("th",{staticClass:"w-64 cabeceraTable font-titulo font-medium"},[t._v("Equipo")]),e("th",{staticClass:"w-64 cabeceraTable font-titulo font-medium"},[t._v("Componente")]),e("th",{staticClass:"w-64 cabeceraTable font-titulo font-medium"},[t._v("Actividad")]),e("th",{staticClass:"w-64 cabeceraTable font-titulo font-medium"},[t._v("Ubicacion")]),e("th",{staticClass:"w-64 cabeceraTable font-titulo font-medium"},[e("p",[t._v("Acciones")])])])])}],_=(a("a9e3"),"http://201.99.110.3:86/api"),x={name:"TablaActividadesCarril",props:{listaActividades:{type:Array,default:function(){return[]}},referenceNumber:{type:String,default:function(){return""}},calendarioId:{type:Number,default:function(){return null}},deshabilitar:{type:Boolean,default:function(){return!1}}},data:function(){return{scrollBool:"",reporteNuevo:!0}},created:function(){var t=this;l["a"].$on("insertar-todas-actividades",(function(){t.insertar_actividades_nuevas()}))},beforeMount:function(){"editar"==this.$route.params.tipoVista?this.reporteNuevo=!1:this.reporteNuevo=!0},destroyed:function(){l["a"].$off("insertar-todas-actividades")},methods:{insertar_actividades_nuevas:function(){var t=this;if(this.reporteNuevo){var e=[];this.listaActividades.forEach((function(a){e.push({referenceNumber:t.referenceNumber,componentJob:parseInt(a.idJob),jobStatus:parseInt(a.jobStatus),flagUpdate:t.reporteNuevo})})),this.$http.post("".concat(_,"/Calendario/CalendarReportActivities/").concat(this.referenceNumber.split("-")[0],"/").concat(this.calendarioId),e).then((function(){}))}},actualizar_actividad:function(t){if(!this.reporteNuevo){var e=[];e.push({referenceNumber:this.referenceNumber,componentJob:parseInt(t.idJob),jobStatus:parseInt(t.jobStatus),flagUpdate:this.reporteNuevo}),this.$http.post("".concat(_,"/Calendario/CalendarReportActivities/").concat(this.referenceNumber.split("-")[0],"/").concat(this.calendarioId),e).then((function(){}))}}}},w=x,I=Object(p["a"])(w,v,C,!1,null,null,null),y=I.exports,N=a("ccc9"),A=a("225c"),E="http://201.99.110.3:86/api",F={components:{HeaderPreventivo:g,TablaActividadesCarril:y,ImagenesActividadCarril:N["a"],Spinner:A["a"]},data:function(){return{referenceNumber:"",header:{},listaActividades:[],observaciones:"",horaFin:"",horaInicio:"",limite:300,objetoLogDate:{},reporteInsert:!0,modalLoading:!1,letras:0,reporteInsertado:!1,adminIdCalendarModify:""}},created:function(){var t=this;l["a"].$on("actualizar_hora_inicio",(function(e){t.horaInicio=e})),l["a"].$on("actualizar_hora_fin",(function(e){t.horaFin=e}))},beforeMount:function(){var t=Object(r["a"])(Object(o["a"])().mark((function t(){var e,a,i,s,r=this;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1!=!this.$route.query.edicion){t.next=15;break}return this.reporteInsert=!0,this.header=this.$route.query.header,t.next=5,this.$store.getters["Login/GET_REFERENCIA_PLAZA_TO_NOMBRE"](this.$route.query.header.plazaNombre);case 5:return e=t.sent,t.next=8,m["a"].crear_referencia_calendario(e.refereciaPlaza,this.header.frequencyName,this.header.day,this.header.lane);case 8:return this.referenceNumber=t.sent,t.next=11,this.$store.getters["Actividades/GET_ACTIVIDADES_CARRIL"];case 11:this.listaActividades=t.sent,0==this.listaActividades.length&&(this.$notify.warning({title:"Ups!",msg:"NO TIENE ACTIVIDADES.",position:"bottom right",styles:{height:100,width:500}}),setTimeout((function(){r.$router.push({path:"/ReportesMantenimiento/TablaActividades"})}),300)),t.next=27;break;case 15:this.reporteInsert=!1,a=this.$route.query.headerCompuesto,this.header={calendarId:a.calendarId,capufeLaneNum:a.capufeLaneNum,dateStamp:a.dateStamp,day:u()(a.fecha).format("DD/MM/YYYY"),frequencyId:a.frequencyId,frequencyName:a.frequencyName,idGare:a.idGare,lane:a.lane,plazaNombre:a.plazaCobro,statusMaintenance:a.statusMaintenance,adminId:a.adminId,squareId:a.squareId},this.observaciones=a.comentarios,this.horaInicio=a.horaInicio,this.horaFin=a.horaFin,i=this.$route.query.actividades,s=[],i.forEach((function(t){s.push({actividades:t.jobDescription,componente:t.componentDescription,equipo:t.activityDescription,frecuencia:a.frequencyName,idJob:t.componentsJobId,jobStatus:t.jobStatusId,ubicacion:t.name})})),this.listaActividades=s,this.referenceNumber=a.referenceNumber,this.reporteInsertado=!0;case 27:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),destroyed:function(){l["a"].$off(["actualizar_hora_inicio","actualizar_hora_fin"])},computed:{restante:function(){var t=this.observaciones.length;return 100==t&&(document.getElementById("obs").value+="\n"),this.observaciones.length}},methods:{modificar_adminid:function(t){this.adminIdCalendarModify=t},guardar_log_fecha:function(t){this.objetoLogDate=t,this.referenceNumber=t.ref},validar_horas:function(){if(""!=this.horaInicio&&""!=this.horaFin){var t=this.horaInicio.split(":"),e=this.horaFin.split(":"),a=new Date(1995,11,17,t[0],t[1],0),i=new Date(1995,11,17,e[0],e[1],0);return a<i||(window.scrollTo(0,top),this.$notify.warning({title:"Ups!",msg:"LA HORA INICIO NO PUEDE SER MAYOR QUE LA HORA FIN.",position:"bottom right",styles:{height:100,width:500}}),!1)}return window.scrollTo(0,top),this.$notify.warning({title:"Ups!",msg:"FALTA LLENAR CAMPOS DE HORA FIN Y HORA INICIO.",position:"bottom right",styles:{height:100,width:500}}),!1},ocultar_modal_loading:function(){var t=this,e="0000"!=this.header.capufeLaneNum?"carril":void 0,a={referenceNumber:this.referenceNumber,frecuenciaId:this.header.frequencyId,tipoEncabezadoLane:e,lane:this.header.lane};setTimeout(Object(r["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.modalLoading=!1,e.next=3,m["a"].generar_pdf_actividades_preventivo(a.referenceNumber,a.frecuenciaId,a.tipoEncabezadoLane);case 3:return e.next=5,m["a"].generar_pdf_fotografico_preventivo(a.referenceNumber,a.lane);case 5:t.$router.push({path:"/ReportesMantenimiento/TablaActividades"});case 6:case"end":return e.stop()}}),e)}))),2e3)},crear_header_reporte:function(t){var e=this;return Object(r["a"])(Object(o["a"])().mark((function a(){var i,s,r,n,c,m,d;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.validar_horas()&&(e.modalLoading=!0,i=e.$store.getters["Login/GET_REFERENCIA_PLAZA_TO_NOMBRE"](e.header.plazaNombre),s=e.$store.getters["Login/GET_USEER_ID_PLAZA_ID"],r="","{}"!=JSON.stringify(e.objetoLogDate)?(n=e.objetoLogDate.fecha.split("/"),r=new Date(n[2],n[1]-1,n[0])):(c=e.header.day.split("/"),r=new Date(c[2],c[1]-1,c[0])),m={ReferenceNumber:e.referenceNumber,SquareId:i.numeroPlaza,CapufeLaneNum:e.header.capufeLaneNum,IdGare:e.header.idGare,UserId:s.idUser,AdminSquare:e.adminIdCalendarModify,ReportDate:r,Start:e.horaInicio,End:e.horaFin,Observations:e.observaciones,CalendarId:parseInt(e.header.calendarId)},d=!1,d=!!e.reporteInsert&&!!t,e.$http.post("".concat(E,"/Calendario/CalendarReportData/").concat(i.refereciaPlaza,"/").concat(d),m).then((function(){if(""!=e.objetoLogDate.fecha){var a=e.referenceNumber.split("-")[0],i=e.$store.getters["Login/GET_USEER_ID_PLAZA_ID"],s={calendarId:parseInt(e.header.calendarId),date:e.objetoLogDate.fecha,userId:i.idUser,referenceNumber:e.referenceNumber,comment:e.objetoLogDate.motivo};e.$http.post("".concat(E,"/Calendario/CalendarDateLog/").concat(a),s).then((function(){}))}e.reporteInsert?(t?(l["a"].$emit("insertar-todas-actividades"),e.modalLoading=!1,e.reporteInsertado=!0):e.ocultar_modal_loading(),e.$notify.success({title:"Ok!",msg:"SE GENERARON LOS REPORTES CORRECTAMENTE.",position:"bottom right",styles:{height:100,width:500}})):(e.$notify.success({title:"Ok!",msg:"SE ACTUALIZARON LAS ACTIVIDADES.",position:"bottom right",styles:{height:100,width:500}}),e.ocultar_modal_loading())})));case 1:case"end":return a.stop()}}),a)})))()}}},D=F,O=Object(p["a"])(D,i,s,!1,null,null,null);e["default"]=O.exports},"7ba4":function(t,e,a){},"7c377":function(t,e,a){"use strict";a("7ba4")},ccc9:function(t,e,a){"use strict";var i=a("ade3"),s=(a("b0c0"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"mr-10 -mt-3 sm:mr-0 sm:ml-4 sm:mt-0 w-full font-titulo",class:{"sm:ml-1 sm:mt-18":"Diagnostico"==t.tipo,"sm:-ml-1":"Ficha"==t.tipo}},[e("p",{staticClass:"text-gray-800 font-titulo mt-2 mb-1 sm:text-sm sm:mb-4",class:{"sm:ml-1 sm:mt-2 -mb-1 mt-4 ml-12 w-20":"Diagnostico"==t.tipo,"ml-5 mb-2 mt-6 lg:ml-73 sm:-ml-48 sm:-mb-1":"Ficha"==t.tipo,"sm:-mt-16":"Editar"==t.$route.params.tipoVista}},[t._v("IMAGENES")]),t.reporteDataInsertada?e("div",{staticClass:"sm:-ml-4",class:{"w-75 ml-4 mr-4 mt-4 sm:w-auto border border-white -mb-4 sm:-mt-18":"Diagnostico"==t.tipo,"w-75 ml-1 sm:ml-10 sm:w-66 sm:-mb-10":"Ficha"==t.tipo,"w-1/3 ml-5 sm:ml-1 sm:w-66 sm:mb-10 lg:ml-73":"Editar"==t.$route.params.tipoVista}},[t.cargandoImagen?e("div",{staticClass:"text-center font-serif text-xs h-40 border border-gray-400 rounded-lg w-full sm:w-66",class:{"sm:w-auto mt-0 sm:mt-2 sm:ml-1 sm:mr-1":"Diagnostico"==t.tipo,"sm:w-full mt-0 sm:mt-2 sm:ml-3":"Ficha"==t.tipo}},[e("div",{staticClass:"mt-5"},[e("div",{staticClass:"p-10"},[e("p",{staticClass:"mb-2"},[t._v("Cargando imagen")]),e("BarraProgreso",{attrs:{color:"blue",percentage:t.progress}})],1)])]):e("div",{staticClass:"inline-flex h-40 border border-gray-400 rounded-lg w-full sm:w-66",class:{"sm:w-66 mt-0 sm:mt-1 sm:-ml-1":"Diagnostico"==t.tipo,"sm:w-full mt-0 sm:mt-2 sm:ml-4":"Ficha"==t.tipo}},[e("div",{staticClass:"w-2/3 grid grid-cols-2 p-2 gap-4 overflow-auto",class:Object(i["a"])({"grid-cols-2":"Actividades"==t.tipo,"grid-cols-1":"Diagnostico"==t.tipo},"grid-cols-1","Ficha"==t.tipo)},t._l(t.arrayImagenes,(function(i){return e("div",{key:i.name,staticClass:"relative border"},[e("span",{staticClass:"absolute border rounded-full top-0 right-0",on:{click:function(e){return t.eliminar_imagen(i.name)}}},[e("img",{staticClass:"w-4 cursor-pointer",attrs:{src:a("04b3")}})]),e("div",{staticClass:"p-2 mx-aut"},[i.imgbase.length<200?e("lazy-image",{attrs:{src:"".concat(i.imgbase),"img-class":["w-32","h-32"],placeholder:"../assets/img/load.gif"}}):e("lazy-image",{attrs:{src:"data:image/jpeg;base64,".concat(i.imgbase),"img-class":["w-32","h-32"],placeholder:"../assets/img/load.gif"}})],1)])})),0),e("div",{staticClass:"w-1/3 border-2 relative border-gray-600 inline-block border-dashed text-center rounded-lg",class:{"":"Diagnostico"==t.tipo}},[e("div",{staticClass:"sm:-mt-4"},[e("input",{staticClass:"h-40 w-full inset-0 absolute opacity-0 cursor-pointer",class:{"cursor-not-allowed":t.anularcarga},attrs:{disabled:t.anularcarga,type:"file",multiple:""},on:{change:t.recibir_imagenes}}),e("font-awesome-icon",{staticClass:"p-5 w-auto text-center flex h-32 xl:ml-8 xl:-mt-6 xl:-mb-6 sm:w-10 sm:h-10 sm:p-1 sm:mt-16 text-blue-800",class:{"sm:h-16 sm:w-16":"Diagnostico"==t.tipo||"Ficha"==t.tipo},attrs:{icon:"fa-solid fa-plus"}}),e("span",{staticClass:"text-sm text-gray-500 sm:hidden"},[t._v("Agregar imagenes")])],1)])]),e("span",{staticClass:"text-gray-500 text-sm border border-white sm:-mt-6 sm:ml-0 sm:w-32"},[t._v(t._s(t.num)+"/"+t._s(t.limiteFotos)+" (Máximo "+t._s(t.limiteFotos)+" fotografías)")])]):e("div",{class:{"w-1/3 ml-5 lg:ml-73":"Diagnostico"==t.tipo,"w-1/3 ml-5 sm:ml-48 lg:ml-73":"Ficha"==t.tipo}},[e("button",{staticClass:"inline-flex h-40 border border-gray-400 bg-gray-300 rounded-lg w-full sm:w-66",class:{"bg-gray-400":t.reporteDataInsertada}},[e("div",{staticClass:"w-2/3 grid p-2 gap-4 overflow-auto bg-gray-300"}),e("div",{staticClass:"w-1/3 border-2 relative border-gray-600 bg-gray-300 inline-block border-dashed text-center rounded-lg sm:h-40"},[e("button",{staticClass:"bg-gray-300",class:{"":"Diagnostico"==t.tipo},attrs:{disabled:t.reporteDataInsertada}},[e("img",{staticClass:"p-5 w-auto mx-auto h-31 sm:w-10 sm:h-10 sm:p-1 sm:mt-16",class:{"sm:h-10 sm:mb-16":"Diagnostico"==t.tipo},attrs:{src:a("ec68")}}),e("span",{staticClass:"text-sm text-gray-500 mb-0 sm:hidden"},[t._v("Agregar imagenes")])])])]),"Diagnostico"==t.tipo?e("p",{staticClass:"-mt-1 text-1xl sm:text-sm text-red-700",class:{"text-center mb-4":"Diag"==t.tipo}},[t._v("Primero debe enviar la información del Reporte")]):e("p",{staticClass:"mt-1 text-sm text-center text-red-700"},[t._v("Para agregar imagenes primero debe crear el reporte")])])])}),o=[],r=a("b85c"),n=a("c7eb"),c=a("1da1"),l=(a("a9e3"),a("99af"),a("ac1f"),a("1276"),a("d3b7"),a("159b"),a("7db0"),a("4de4"),a("046c")),m=function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-full bg-gray-200 h-2 relative overflow-hidden",class:[{"rounded-full":t.rounded},{indeterminate:t.indeterminate}]},[e("div",{staticClass:"h-full progressbar",class:["bg-".concat(t.color,"-500"),{"absolute top-0":t.indeterminate},{"rounded-full":t.rounded}],style:{width:"".concat(t.percentage,"%")},attrs:{role:"progressbar","aria-valuenow":t.percentage,"aria-valuemin":"0","aria-valuemax":"100"}},[e("span",{staticClass:"flex items-center h-full"},[t._t("default")],2)])])},d=[],u={inheritAttrs:!1,props:{color:{type:String,default:"teal"},percentage:{type:Number,default:0},rounded:{type:Boolean,default:!0},indeterminate:Boolean}},f=u,h=(a("7c377"),a("2877")),p=Object(h["a"])(f,m,d,!1,null,"55df656c",null),b=p.exports,g=a("c1df"),v=a.n(g),C="http://201.99.110.3:86/api",_={props:{referenceNumber:{type:String,default:function(){return""}},tipo:{type:String,default:function(){return"Actividades"}},reporteDataInsertada:{type:Boolean,default:function(){return!1}},maximofotosanexo:{type:Number,default:0},referenciaAnexo:{type:String,default:function(){return""}},subversionAnexo:{type:Boolean,default:function(){return!1}},editar:{type:Boolean,default:function(){return!1}}},components:{BarraProgreso:b},data:function(){return{arrayImagenes:[],cargandoImagen:!1,progress:20,seconds:6,countdown:5,expires_in:null,interval:null,limiteFotos:0,rand:1,anularcarga:!1}},destroyed:function(){this.arrayImagenes=[],clearInterval(this.interval)},beforeMount:function(){var t=this;"Anexo"==this.tipo?setTimeout((function(){var e="";t.limiteFotos=t.maximofotosanexo;var a=[];e="".concat(C,"/ReporteFotografico/Images/GetPaths/").concat(t.referenceNumber.split("-")[0],"/").concat(t.referenceNumber,"/").concat(t.referenciaAnexo,"/").concat(t.subversionAnexo),console.log(e),t.$http.get(e).then((function(e){console.log(e.data),e.data.forEach((function(i){a.push(i);var s="".concat(C,"/ReporteFotografico/EquipoNuevo/Images/").concat(t.referenceNumber.split("-")[0],"/").concat(t.referenceNumber);if(404!=e.status){var o=[];a.forEach((function(e){o.push({name:e,imgbase:"".concat(s,"/").concat(e,"/").concat(t.referenciaAnexo,"/").concat(t.subversionAnexo)})})),t.arrayImagenes=o,t.arrayImagenes.length==t.limiteFotos?(console.log(t.arrayImagenes.length),console.log(t.limiteFotos),t.anularcarga=!0):t.anularcarga=!1}}))}))}),2e3):setTimeout((function(){var e="";"Actividades"==t.tipo?(t.limiteFotos=36,e="".concat(C,"/ReporteFotografico/MantenimientoPreventivo/Images/GetPaths/").concat(t.referenceNumber.split("-")[0],"/").concat(t.referenceNumber)):"Diagnostico"==t.tipo?(t.limiteFotos=4,e="".concat(C,"/DiagnosticoFalla/Images/GetPaths/").concat(t.referenceNumber.split("-")[0],"/").concat(t.referenceNumber)):"Anexo"==t.tipo?(t.limiteFotos=t.maximofotosanexo,e="".concat(C,"/ReporteFotografico/Images/GetPaths/").concat(t.referenceNumber.split("-")[0],"/").concat(t.referenceNumber,"/").concat(t.referenciaAnexo,"/").concat(t.subversionAnexo)):(t.limiteFotos=4,e="".concat(C,"/FichaTecnicaAtencion/Images/GetPaths/").concat(t.referenceNumber.split("-")[0],"/").concat(t.referenceNumber)),t.$http.get(e).then((function(e){var a="";if(a="Actividades"==t.tipo?"".concat(C,"/ReporteFotografico/MantenimientoPreventivo/Images/").concat(t.referenceNumber.split("-")[0],"/").concat(t.referenceNumber):"Diagnostico"==t.tipo?"".concat(C,"/DiagnosticoFalla/Images/").concat(t.referenceNumber.split("-")[0],"/").concat(t.referenceNumber):"".concat(C,"/FichaTecnicaAtencion/Images/").concat(t.referenceNumber.split("-")[0],"/").concat(t.referenceNumber),404!=e.status){var i=[];e.data.forEach((function(t){i.push({name:t,imgbase:"".concat(a,"/").concat(t)})})),t.arrayImagenes=i}}))}),500)},computed:{num:function(){return this.arrayImagenes.length}},methods:{recibir_imagenes:function(){var t=Object(c["a"])(Object(n["a"])().mark((function t(e){return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.$emit("bloquear-boton-diagnostico",!0),t.next=3,this.enviar_imagenes(e);case 3:this.arrayImagenes.length==this.limiteFotos?(console.log(this.arrayImagenes.length),console.log(this.limiteFotos),this.anularcarga=!0):this.anularcarga=!1,this.cargandoImagen=!0,this.countdown=v.a.utc(this.seconds).format("HH:mm:ss"),this.expires_in=this.seconds,this._setInterval();case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),_setInterval:function(){var t=this;this.interval=setInterval((function(){1===t.expires_in?(t.progress=20,t.cargandoImagen=!1,t.$emit("bloquear-boton-diagnostico",!1)):0===t.expires_in?clearInterval(t.interval):(t.expires_in-=1,t.progress+=15,t.countdown=v.a.utc(1e3*t.expires_in).subtract(1,"seconds").format("HH:mm:ss"))}),1e3)},enviar_imagenes:function(){var t=Object(c["a"])(Object(n["a"])().mark((function t(e){var a,i,s,o,c,m,d,u,f=this;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=this.arrayImagenes.some((function(t){return t.name.split("-")[0]!=f.referenceNumber})),i="",1!=a&&0!=this.arrayImagenes.length){t.next=29;break}s={},"Actividades"==this.tipo?(s="".concat(C,"/ReporteFotografico/MantenimientoPreventivo/Images/").concat(this.referenceNumber.split("-")[0],"/").concat(this.referenceNumber),i={rutaGetImagen:"".concat(C,"/ReporteFotografico/MantenimientoPreventivo/Images"),tipo:1}):"ConcentradoDTC"==this.tipo?(this.limiteFotos=100,s="".concat(C,"/dtcData/EquipoDañado/Images/").concat(this.referenceNumber.split("-")[0],"/").concat(this.referenceNumber),i={rutaGetImagen:"".concat(C,"/dtcData/EquipoDañado/Images"),tipo:4}):"Anexo"==this.tipo?(1==this.editar&&(this.subversionAnexo=!0),this.limiteFotos=this.maximofotosanexo,s="".concat(C,"/ReporteFotografico/EquipoNuevo/Images/").concat(this.referenceNumber.split("-")[0],"/").concat(this.referenceNumber,"/").concat(this.referenciaAnexo,"/").concat(this.subversionAnexo),i={rutaGetImagen:"".concat(C,"/ReporteFotografico/EquipoNuevo/Images"),tipo:5}):"Diagnostico"==this.tipo?(s="".concat(C,"/DiagnosticoFalla/Images/").concat(this.referenceNumber.split("-")[0],"/").concat(this.referenceNumber),i={rutaGetImagen:"".concat(C,"/DiagnosticoFalla/Images"),tipo:2}):(s="".concat(C,"/FichaTecnicaAtencion/Images/").concat(this.referenceNumber.split("-")[0],"/").concat(this.referenceNumber),i={rutaGetImagen:"".concat(C,"/FichaTecnicaAtencion/Images"),tipo:3}),o=Object(r["a"])(e.target.files),t.prev=6,o.s();case 8:if((c=o.n()).done){t.next=21;break}if(m=c.value,!(this.arrayImagenes.length+1<=this.limiteFotos)){t.next=19;break}if(d=new FormData,"ConcentradoDTC"!=this.tipo||(u=this.$store.state.Login.cookiesUser.plazasUsuario.find((function(t){return t.refereciaPlaza=f.referenceNumber.split("-")[0]})),d.append("id",this.referenceNumber),d.append("plaza",u.plazaNombre)),d.append("image",m),"image/png"!=m.type&&"image/jpeg"!=m.type){t.next=18;break}return t.next=16,this.$http.post(s,d).then((function(t){f.arrayImagenes=l["a"].obtener_array_imagenes_agregadas(t.data,f.arrayImagenes,i,f.subversionAnexo,f.referenciaAnexo)}));case 16:t.next=19;break;case 18:this.$notify.warning({title:"Error!",msg:"SOLO PUEDE SUBIR IMAGENES.",position:"bottom right",styles:{height:100,width:500}});case 19:t.next=8;break;case 21:t.next=26;break;case 23:t.prev=23,t.t0=t["catch"](6),o.e(t.t0);case 26:return t.prev=26,o.f(),t.finish(26);case 29:case"end":return t.stop()}}),t,this,[[6,23,26,29]])})));function e(e){return t.apply(this,arguments)}return e}(),eliminar_imagen:function(t){var e=this;if(this.arrayImagenes.length>1){if(t.split("_")[0]==this.referenceNumber){var a="";"Actividades"==this.tipo?a="".concat(C,"/ReporteFotografico/MantenimientoPreventivo/Images/DeleteImg/").concat(this.referenceNumber.split("-")[0],"/").concat(this.referenceNumber,"/").concat(t):"Diagnostico"==this.tipo?a="".concat(C,"/DiagnosticoFalla/Images/DeleteImg/").concat(this.referenceNumber.split("-")[0],"/").concat(this.referenceNumber,"/").concat(t):"Anexo"==this.tipo?(this.anularcarga=!1,1==this.editar&&(this.subversionAnexo=!0),a="".concat(C,"/ReporteFotografico/EquipoNuevo/Images/DeleteImg/").concat(this.referenceNumber.split("-")[0],"/").concat(this.referenceNumber,"/").concat(t,"/").concat(this.referenciaAnexo,"/").concat(this.subversionAnexo)):a="".concat(C,"/FichaTecnicaAtencion/Images/DeleteImg/").concat(this.referenceNumber.split("-")[0],"/").concat(this.referenceNumber,"/").concat(t),this.$http.get(a).then((function(){e.$notify.success({title:"Ok!",msg:"SE ELIMINO LA IMAGEN CORRECTAMENTE.",position:"bottom right",styles:{height:100,width:500}})}))}this.$nextTick((function(){var a=e.arrayImagenes.filter((function(e){return e.name!=t}));e.arrayImagenes=[],e.arrayImagenes=a}))}else this.$notify.warning({title:"Ok!",msg:"SIEMPRE DEBE TENER MINIMO UNA FOTO.",position:"bottom right",styles:{height:100,width:500}})}}},x=_,w=Object(h["a"])(x,s,o,!1,null,null,null);e["a"]=w.exports},f1c9:function(t,e,a){"use strict";a("44e8")}}]);
//# sourceMappingURL=chunk-d13534ea.8e365135.js.map